<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Page Title</title>
    <!-- Header 프래그먼트 포함 -->
    <th:block th:replace="common/fragments/index :: header-fragment"></th:block>
</head>
<body>

<!-- 페이지 래퍼 -->
<div id="wrapper">
    <!-- 사이드바 -->
    <th:block th:replace="common/fragments/index :: sidebar-fragment"></th:block>

    <!-- 콘텐츠 래퍼 -->
    <div id="content-wrapper" class="d-flex flex-column">
        <!-- 메인 콘텐츠 -->
        <div id="content">
            <!-- 탑바 -->
            <th:block th:replace="common/fragments/index :: topbar-fragment"></th:block>

            <!-- 페이지 콘텐츠 시작 -->
            <div class="container-fluid">
                <!-- Page Heading -->
                <h1 class="h3 mb-2 text-gray-800">재고 실사</h1>
                <p class="mb-4">DataTables is a third party plugin that is used to generate the demo table below.
                    For more information about DataTables, please visit the <a target="_blank"
                                                                               href="https://datatables.net">official
                        DataTables documentation</a>.</p>

                <!-- DataTales Example -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3 d-flex justify-content-between align-items-center">
                        <h6 class="m-0 font-weight-bold text-primary">재고 실사 조회</h6>
                        <div>
                            <button id="all-date-button" class="btn btn-primary">All</button>
                            <button id="today-date-button" class="btn btn-primary">Today</button>
                            <button id="month-date-button" class="btn btn-primary">This Month</button>
                            <button id="year-date-button" class="btn btn-primary">This Year</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-6">
                                    <label for="startDate-input">시작일</label>
                                    <input type="date" id="startDate-input" class="form-control"/>

                                </div>
                                <div class="col-md-6">
                                    <label for="endDate-input">종료일</label>
                                    <input type="date" id="endDate-input" class="form-control"/><br>
                                </div>

                                <div class="col-md-4"> <!-- 1열 시작 -->


                                    <label for="selectBrandBtn">브랜드</label>
                                    <button type="button" id="selectBrandBtn" class="btn btn-primary" data-toggle="modal" data-target="#brandModal" style="padding: 0.05rem 0.2rem; font-size: 0.8rem;">+</button>

                                    <input type="text" id="brand-input" class="form-control" placeholder="------------------" readonly> <!-- Set readonly to prevent direct typing -->


                                    <!-- Modal -->
                                    <div class="modal fade" id="brandModal" tabindex="-1" role="dialog" aria-labelledby="brandModalLabel" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="brandModalLabel">브랜드를 선택해 주세요</h5>

                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <select id="majorType-input" class="form-control">
                                                        <option value="" selected disabled hidden>
                                                            --- 대분류 ---
                                                        </option>
                                                        <option value="major1">대분류 옵션 1</option>
                                                        <option value="major2">대분류 옵션 2</option>
                                                        <option value="major3">대분류 옵션 3</option>
                                                    </select>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">확인</button>
                                                    <!-- Add a button to confirm selection -->
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
                                                    <!-- Add a button to confirm selection -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                </div> <!-- 1열 끝 -->
                                <div class="col-md-4"> <!-- 2열 시작 -->

                                    <label for="storage-list">창고</label>
                                    <select id="storage-list" class="form-control">
                                        <option value="" selected disabled hidden>
                                            --- 창고이름 ---
                                        </option>
                                        <option value="large-category1">야옹이창고</option>
                                        <option value="large-category2">고냥이창고</option>
                                        <option value="large-category3">주인님창고</option>
                                    </select>

                                    <br>
                                </div> <!-- 2열 끝 -->
                                <div class="col-md-4"> <!-- 3열 시작 -->

                                    <label for="Manager-input">담당자</label>
                                    <input type="text" id="Manager-input" class="form-control" placeholder="담당자ID"/><br>

                                </div> <!-- 3열 끝 -->
                                <div class="col-md-12">
                                    <label for="search-input"></label>
                                    <input type="text" id="search-input" class="form-control" placeholder="검색을 위한 실사번호를 입력해주세요."/><br>
                                </div>
                            </div> <!-- 각 행의 끝 -->
                            <div class="row">
                                <div class="col-md-12" style="text-align: right;"> <!-- 전체 간격을 일정하게 열 맞춤 -->
                                    <button id="retrieval-register-button" class="btn btn-primary">검색</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- DataTales Example -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">재고 실사 조회</h6>
                    </div>
                    <div class="card-body">
                        <label for="dataTable">Total 00</label>
                        <br>
                        <div class="table-responsive">
                            <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                                <thead>
                                <tr style="background-color:#4e73df; color: white;">
                                    <th></th>
                                    <th>실사번호</th>
                                    <th>실사일자</th>
                                    <th>담당자</th>
                                    <th>상태</th>
                                    <th>상태상세</th>
                                </tr>
                                </thead>
                                <tfoot>

                                </tfoot>
                                <tbody>
                                <!-- Thymeleaf loop for dynamic data -->

                                <tr th:each="stockTaking : ${stList}" >
                                    <th>
                                        <input type="checkbox" name="inspection-checkbox" th:id="'inspection-checkbox-' + ${stockTaking.stockTakingId}">
                                    </th>
                                    <td>
                                        <button type="button" class="btn btn-link toggle-detail" th:data-stock-id="${stockTaking.stockTakingId}" th:text="${stockTaking.stockTakingId}"></button>
                                    </td>
                                    <td th:text="${stockTaking.plannedDate}"></td>
                                    <td th:text="${stockTaking.inspector}"></td>
                                    <td th:text="${stockTaking.status}"></td>
                                    <td th:text="${stockTaking.statusDetail}"></td>
                                </tr>
                                </tbody>
                            </table>


                            <div class="pagination" style="justify-content: center;">
                                <a href="#" class="pagination-number">&laquo;&emsp;</a>
                                <a href="#" class="pagination-number" >1&emsp;</a>
                                <a href="#" class="pagination-number">2&emsp;</a>
                                <a href="#" class="pagination-number">3&emsp;</a>
                                <a href="#" class="pagination-number">4&emsp;</a>
                                <a href="#" class="pagination-number">5&emsp;</a>
                                <a href="#" class="pagination-number">6&emsp;</a>
                                <a href="#" class="pagination-number">&raquo;</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 재고 실사 디테일 -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">재고 실사 디테일</h6>
                    </div>
                    <div class="card-body">
                        <label for="total-list-detail-output1">Total 00</label>
                        <br>
                        <div class="table-responsive">
                            <table class="table table-bordered" id="total-list-detail-output1" width="100%" cellspacing="0">
                                <thead>
                                <tr style="background-color:#4e73df; color: white;">
                                    <th>제품아이디</th>
                                    <th>제품명</th>
                                    <th>분류</th>
                                    <th>전산재고</th>
                                    <th>실사재고</th>
                                    <th>조정수량</th>
                                    <th>상태</th>
                                    <th>상세정보</th>
                                </tr>
                                </thead>
                                <tbody>
                                <!-- Thymeleaf loop for dynamic detail data -->
                                <tr th:each="detail : ${stDetailList}">
                                    <td th:text="${detail.productId}"></td>
                                    <td th:text="${detail.productName}"></td>
                                    <td th:text="${detail.productSubCategory}"></td>
                                    <td th:text="${detail.computerizedStock}"></td>
                                    <td th:text="${detail.actualStock}"></td>
                                    <td th:text="${detail.adjustmentQuantity}"></td>
                                    <td th:text="${detail.status}"></td>
                                    <td th:text="${detail.statusDetail}"></td>
                                </tr>
                                </tbody>


                            </table>

                            <!-- Pagination -->
                            <div class="pagination" style="justify-content: center;">
                                <a href="#" class="pagination-number">&laquo;&emsp;</a>
                                <a href="#" class="pagination-number" >1&emsp;</a>
                                <a href="#" class="pagination-number">2&emsp;</a>
                                <a href="#" class="pagination-number">3&emsp;</a>
                                <a href="#" class="pagination-number">4&emsp;</a>
                                <a href="#" class="pagination-number">5&emsp;</a>
                                <a href="#" class="pagination-number">6&emsp;</a>
                                <a href="#" class="pagination-number">&raquo;</a>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- 푸터 -->
    <th:block th:replace="common/fragments/index :: footer-fragment"></th:block>
</div>
</div>

<!-- 스크롤 탑 버튼 -->
<th:block th:replace="common/fragments/index :: scroll-to-top-fragment"></th:block>

<!-- 로그아웃 모달 -->
<th:block th:replace="common/fragments/index :: logout-modal-fragment"></th:block>

<!-- 스크립트 -->
<th:block th:replace="common/fragments/index :: scripts-fragment"></th:block>

<script th:inline="javascript">
    /* <![CDATA[ */
    $(document).ready(function() {
        $('.toggle-detail').click(function() {
            var stockId = $(this).data('stock-id');
            $.ajax({
                url: '/stock/stockTaking/details?stockTakingId=' + stockId,
                type: 'GET',
                success: function(data) {
                    var detailsTable = $('#total-list-detail-output1 tbody');
                    detailsTable.empty(); // 테이블 초기화
                    data.forEach(function(detail) {
                        const newRow = `<tr>
                    <td>${detail.productId}</td>
                    <td>${detail.productName}</td>
                    <td>${detail.productSubCategory}</td>
                    <td>${detail.computerizedStock}</td>
                    <td>${detail.actualStock}</td>
                    <td>${detail.adjustmentQuantity}</td>
                    <td>${detail.status}</td>
                    <td>${detail.statusDetail}</td>
                </tr>`;
                        detailsTable.append(newRow);
                    });
                },
                error: function(error) {
                    console.log("Error: ", error);
                }
            });
        });
    });
    /* ]]> */
</script>





</body>


</html>
