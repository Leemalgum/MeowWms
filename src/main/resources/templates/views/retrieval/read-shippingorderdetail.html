<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <meta charset="UTF-8">
    <title>MeowWMS :: 출고 지시서 상세</title>
    <th:block th:replace="common/fragments/index :: header-fragment"></th:block>
</head>
<body>

<div id="wrapper">
    <th:block th:replace="common/fragments/index :: sidebar-fragment"></th:block>

    <div id="content-wrapper" class="d-flex flex-column">
        <div id="content">
            <th:block th:replace="common/fragments/index :: topbar-fragment"></th:block>

            <div class="container-fluid">
                <!-- Page Heading -->
                <h1 class="h3 mb-2 text-gray-800">출고 상세 정보</h1>
                <p class="mb-4"></p>

                <!-- Shipping Order Details -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">출고 상세 정보</h6>
                    </div>
                    <div class="card-body">
                        <div class="container-fluid">
                            <div class="row">
                                <!-- 출고 요청 -->
                                <div class="col-md-3 mb-3">
                                    <div class="bg-light p-3">
                                        <h5 class="font-weight-bold text-primary">출고 요청</h5>
                                        <p>요청 시간 : <br><span th:if="${shippingOrderDetails.requestTime != null}"
                                                             th:text="${shippingOrderDetails.requestTime}"
                                                             th:else="대기중"></span></p>
                                    </div>
                                </div>
                                <!-- 출고 승인 -->
                                <div class="col-md-3 mb-3">
                                    <div class="bg-light p-3">
                                        <h5 class="font-weight-bold text-primary">출고 승인</h5>
                                        <p>승인 시간 : <br><span th:if="${shippingOrderDetails.orderTime != null}"
                                                             th:text="${shippingOrderDetails.orderTime}"
                                                             th:else="대기중"></span></p>
                                    </div>
                                </div>
                                <!-- 출고 작업 진행중 -->
                                <div class="col-md-3 mb-3">
                                    <div class="bg-light p-3">
                                        <h5 class="font-weight-bold text-primary">출고 작업 진행중</h5>
                                        <p>작업 시작 시간 : <br><span th:if="${shippingOrderDetails.workingTime != null}"
                                                                th:text="${shippingOrderDetails.workingTime}"
                                                                th:else="대기중"></span></p>
                                    </div>
                                </div>
                                <!-- 출고 완료 -->
                                <div class="col-md-3 mb-3">
                                    <div class="bg-light p-3">
                                        <h5 class="font-weight-bold text-primary">출고 완료</h5>
                                        <p>완료 시간 : <br><span th:if="${shippingOrderDetails.finishedTime != null}"
                                                             th:text="${shippingOrderDetails.finishedTime}"
                                                             th:else="대기중"></span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            <!--</div>-->


            <!-- Shipping Order Details -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">출고 상세 정보</h6>
                </div>
                <div class="card-body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-6"> <!-- 1열 시작 -->
                                <label for="shippingOrderId-input">출고 번호</label>
                                <input type="text" id="shippingOrderId-input" class="form-control"
                                       th:value="${shippingOrderDetails.id}" readonly/><br>
                                <label for="uid-input">회원 아이디</label>
                                <input type="text" id="uid-input" class="form-control"
                                       th:value="${shippingOrderDetails.uid}" readonly/><br>
                                <label for="postcode-input">우편번호</label>
                                <input type="text" id="postcode-input" class="form-control"
                                       th:value="${shippingOrderDetails.postcode}" readonly/><br>
                                <label for="streetNameAddress-input">도로명 주소</label>
                                <input type="text" id="streetNameAddress-input" class="form-control"
                                       th:value="${shippingOrderDetails.streetNameAddress}" readonly/><br>
                                <label for="streetNumberAddress-input">지번 주소</label>
                                <input type="text" id="streetNumberAddress-input" class="form-control"
                                       th:value="${shippingOrderDetails.streetNumberAddress}" readonly/><br>
                                <label for="detailAddress-input">상세 주소</label>
                                <input type="text" id="detailAddress-input" class="form-control"
                                       th:value="${shippingOrderDetails.detailAddress}" readonly/><br>
                            </div> <!-- 1열 끝 -->
                            <div class="col-md-6"> <!-- 2열 시작 -->
                                <label for="expectedDate-input">출고 희망일</label>
                                <input type="date" id="expectedDate-input" class="form-control"
                                       th:value="${shippingOrderDetails.expectedDate}" readonly/><br>
                                <label for="productId-input">제품 아이디</label>
                                <input type="text" id="productId-input" class="form-control"
                                       th:value="${shippingOrderDetails.productId}" readonly/><br>
                                <label for="name-input">제품명</label>
                                <input type="text" id="name-input" class="form-control"
                                       th:value="${shippingOrderDetails.name}" readonly/><br>
                                <label for="quantity-input">상품 수량</label>
                                <input type="number" id="quantity-input" class="form-control"
                                       th:value="${shippingOrderDetails.quantity}" readonly/><br>
                                <label for="brand-input">브랜드</label>
                                <input type="text" id="brand-input" class="form-control"
                                       th:value="${shippingOrderDetails.brand}" readonly/><br>
                                <label for="price-input">가격</label>
                                <input type="number" id="price-input" class="form-control"
                                       th:value="${shippingOrderDetails.price}" readonly/><br>
                                <label for="salePrice-input">할인 가격</label>
                                <input type="number" id="salePrice-input" class="form-control"
                                       th:value="${shippingOrderDetails.salePrice}" readonly/><br>
                                <label for="volume-input">부피</label>
                                <input type="number" id="volume-input" class="form-control"
                                       th:value="${shippingOrderDetails.volume}" readonly/><br>
                            </div> <!-- 2열 끝 -->
                        </div>
                        <div class="container-fluid d-flex justify-content-end">
                            <!-- 삭제 버튼 -->
                            <!-- 삭제 기능 구현 시 추가 -->
                            <button type="button" class="btn btn-danger mr-2" id="remove-shippingorder-button">삭제</button>
                            <button type="button" class="btn btn-primary mr-2"
                                    th:onclick="'javascript:redirectToModifyPage(\'' + ${shippingOrderDetails.id} + '\')'">
                                수정
                            </button>
                            <!-- 리스트 버튼 -->
                            <a href="/retrieval/list" class="btn btn-secondary">리스트</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <th:block th:replace="common/fragments/index :: footer-fragment"></th:block>
</div>
</div>
<th:block th:replace="common/fragments/index :: scroll-to-top-fragment"></th:block>
<th:block th:replace="common/fragments/index :: logout-modal-fragment"></th:block>
<th:block th:replace="common/fragments/index :: scripts-fragment"></th:block>

<!-- 수정 버튼 클릭 시 이동할 경로 -->
<script th:inline="javascript">
    function redirectToModifyPage(shippingOrderId) {
        window.location.href = '/retrieval/modifyshippingorder/' + shippingOrderId;
    }
</script>

<!-- 삭제버튼 누르면 수정된 정보 전송 -->
<script th:inline="javascript">
    document.getElementById("remove-shippingorder-button").addEventListener("click", function() {

        // 사용자가 입력한 값을 가져옴
        var shippingOrderId = document.getElementById("shippingOrderId-input").value;

        // 확인 창 표시
        if (confirm("정말로 삭제하시겠습니까?")) {
            // 데이터를 JSON 형식으로 변환
            var shippingOrderDetailsData = {
                id: shippingOrderId
            };

            // 서버에 데이터를 전송
            fetch('/retrieval/removeshippingorder', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    shippingOrderDetails: shippingOrderDetailsData
                })
            })
                .then(response => {
                    // 서버 응답 처리
                    if (response.ok) {
                        // 리다이렉트
                        window.location.href = "/retrieval/main";
                    } else {
                        // 오류가 발생했을 때 할 작업
                        console.log('오류 발생');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        } else {
            // 사용자가 취소를 선택한 경우 아무 작업도 수행하지 않음
        }

    });
</script>


</body>
</html>
